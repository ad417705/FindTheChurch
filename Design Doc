Design Document:
# Find the Church - Design Document

## 1. Project Overview

**Mission**: Remove every barrier between people and their church community. When someone says "I can't find a church near me," we make that excuse impossible. We connect seekers to local congregations, making church discovery effortless and accessible.

**Core Value Proposition**: A clean, unbiased church discovery platform that focuses on factual information and location-based search rather than subjective ratings. Whether you're new to faith, relocating, or simply exploring, finding your spiritual home should be simple.

**MVP Approach**: Start with **no user authentication required** - users can browse and search churches without creating accounts. Authentication will be added in Phase 2 for features like favorites and check-ins.

## 2. Technical Stack

### Frontend
- **Framework**: Next.js 14+ (App Router)
- **Styling**: Tailwind CSS
- **Maps**: Mapbox GL JS or Google Maps API
- **State Management**: React Context/Zustand (for simple state)

### Backend
- **Framework**: Next.js API Routes (serverless functions)
- **Database**: PostgreSQL via Supabase
- **Authentication**: Supabase Auth
- **File Storage**: Supabase Storage (for church images)

### Why This Stack?
- Next.js provides SSR/SSG for SEO (important for church discovery)
- Supabase offers real-time subscriptions, auth, and PostGIS for geospatial queries
- All components integrate seamlessly and scale well

## 3. Core Features (MVP)

### Phase 1: Basic Discovery (No Authentication Required)
1. **Browse churches without login** - Public access to all church listings
2. **Location-based search** - Find churches near user's current location
3. **State/City search** - Explore churches in different regions nationwide
4. **Church detail pages** - View comprehensive church information
5. **Simple filtering** - By denomination, service times, size
6. **Map integration** - Interactive map showing church locations

### Phase 2: User Engagement (Future - Requires Authentication)
1. **User accounts** - Optional registration to unlock additional features
2. **Save favorite churches** - Bookmark churches for later reference
3. **Check-ins** - Users can mark attendance (factual, not ratings)
4. **Personal history** - Track churches visited

### Phase 3: Church Management (Future)
1. **Church self-registration** - Allow churches to add themselves to the platform
2. **Church admin claims** - Existing churches can claim and manage their listings
3. **Verified data** - Badge system for churches that verify their information
4. **Updated service times** - Churches can update their own schedules

## 4. Database Schema

### Tables

#### `churches`
```sql
id                UUID PRIMARY KEY
name              VARCHAR(255) NOT NULL
denomination      VARCHAR(100)
address           TEXT NOT NULL
city              VARCHAR(100) NOT NULL
state             VARCHAR(2) NOT NULL
zip_code          VARCHAR(10)
country           VARCHAR(50) DEFAULT 'USA'
latitude          DECIMAL(10, 8) NOT NULL
longitude         DECIMAL(11, 8) NOT NULL
phone             VARCHAR(20)
email             VARCHAR(255)
website           VARCHAR(255)
description       TEXT
founded_year      INTEGER
avg_attendance    INTEGER
service_times     JSONB -- {sunday: ["9am", "11am"], wednesday: ["7pm"]}
languages         TEXT[] -- ["English", "Spanish"]
image_url         TEXT
verified          BOOLEAN DEFAULT FALSE
created_at        TIMESTAMP DEFAULT NOW()
updated_at        TIMESTAMP DEFAULT NOW()
```

#### `users`
```sql
id                UUID PRIMARY KEY (from Supabase Auth)
email             VARCHAR(255) UNIQUE NOT NULL
full_name         VARCHAR(255)
location_city     VARCHAR(100)
location_state    VARCHAR(2)
created_at        TIMESTAMP DEFAULT NOW()
updated_at        TIMESTAMP DEFAULT NOW()
```

#### `favorites` (Future Phase)
```sql
id                UUID PRIMARY KEY
user_id           UUID REFERENCES users(id)
church_id         UUID REFERENCES churches(id)
created_at        TIMESTAMP DEFAULT NOW()
UNIQUE(user_id, church_id)
```

#### `check_ins` (Future Phase)
```sql
id                UUID PRIMARY KEY
user_id           UUID REFERENCES users(id)
church_id         UUID REFERENCES churches(id)
check_in_date     DATE NOT NULL
created_at        TIMESTAMP DEFAULT NOW()
```

### Indexes
```sql
CREATE INDEX idx_churches_location ON churches USING GIST (
  geography(ST_MakePoint(longitude, latitude))
);
CREATE INDEX idx_churches_state_city ON churches(state, city);
CREATE INDEX idx_churches_denomination ON churches(denomination);
```

## 5. Key API Endpoints

### Church Discovery
- `GET /api/churches` - List churches with pagination
  - Query params: `lat`, `lng`, `radius`, `state`, `city`, `denomination`, `page`
- `GET /api/churches/[id]` - Get single church details
- `GET /api/churches/nearby` - Find churches near coordinates
- `GET /api/churches/search` - Text search by name or location

### User Management (Future)
- `POST /api/auth/signup` - Create account
- `POST /api/auth/login` - Authenticate
- `GET /api/users/favorites` - Get user's saved churches
- `POST /api/users/favorites` - Save a church

### Admin (Future)
- `POST /api/churches` - Add new church (admin or claimed)
- `PUT /api/churches/[id]` - Update church info
- `POST /api/churches/[id]/claim` - Church admin claims listing

## 6. User Flows

### Primary Flow: Finding a Church
1. User lands on homepage
2. System detects location OR user enters city/state
3. Map displays churches in area with list view
4. User filters by denomination/service time
5. User clicks church to view details
6. User gets directions or visits website

### Secondary Flow: Exploring New Areas
1. User searches for "Dallas, TX" or "California"
2. Map updates to show churches in that region
3. User browses and explores different churches
4. User can save churches for later (with account)

## 7. Avoiding Bias: Design Decisions

Instead of ratings/reviews, focus on **factual, objective information**:

✅ **Include**:
- Check-in counts (shows activity level)
- Verified attendance numbers (from church admins)
- Service times and languages offered
- Denomination and doctrinal statements
- Photos and basic descriptions
- Links to church's own website/social media

❌ **Exclude**:
- Star ratings
- Written reviews
- Comparison rankings
- "Best church" algorithms

**Alternative**: Consider a "Verified Visitor" badge for users who've checked in 3+ times, adding credibility without subjective opinions.

## 8. Development Roadmap

### Week 1-2: Setup & Foundation
- Initialize Next.js 14+ project with App Router
- Set up Supabase project and configure database
- Create initial church schema
- Set up Google Places API credentials
- Configure environment variables and deployment settings

### Week 3-4: Data Layer & API Integration
- Build API route to fetch churches from Google Places API
- Create caching strategy to store results in Supabase
- Implement geolocation functionality
- Build church search endpoints (by location, city, state)
- Add pagination and filtering logic

### Week 5-6: Frontend & Map Integration
- Build homepage with map component (Mapbox or Google Maps)
- Create church list view with cards
- Implement church detail pages
- Add search and filter UI
- Make design responsive for mobile

### Week 7-8: Polish & Launch MVP
- Add loading states and error handling
- Optimize for SEO (metadata, sitemap)
- Test across devices and browsers
- Deploy to Vercel
- Set up analytics and monitoring

### Post-MVP: Phase 2 Features
- Add Supabase Auth for user accounts
- Build favorites and check-in features
- Create user profile pages
- Implement church claim system (Phase 3)

## 9. Next.js Development Focus Areas

Key Next.js concepts essential for this project:

1. **App Router basics** - File-based routing in `app/` directory
2. **Server vs Client Components** - "use client" directive
3. **Data fetching** - Server-side and client-side patterns
4. **API Routes** - Building endpoints in `app/api/`
5. **Metadata & SEO** - Dynamic metadata for church pages

## 10. Open Questions to Decide

### Church Data Strategy

**Option 1: Google Places API (Recommended for MVP)**
- **Pros**: 
  - Access to existing church data immediately
  - No manual data entry needed
  - Includes addresses, phone numbers, websites, photos
  - 10,000 free API calls per month
  - Users can discover churches right away
- **Cons**: 
  - Costs money after free tier ($17 per 1,000 requests)
  - Limited control over data accuracy
  - May have incomplete information for some churches
- **Best for**: Getting started quickly with real data

**Option 2: Manual Curation**
- **Pros**: 
  - Complete control over data quality
  - Can ensure accurate, detailed information
  - No ongoing API costs
- **Cons**: 
  - Time-intensive to build initial database
  - Slow to scale
  - Requires significant upfront work
- **Best for**: Long-term goal after proving concept

**Option 3: Hybrid Approach (Recommended Long-Term)**
- Start with Google Places API to populate initial database
- Cache results in your database to reduce API costs
- Allow churches to claim and enhance their listings (Phase 3)
- Gradually build proprietary database with richer information
- Eventually reduce dependence on Google Places

### Other Decisions
1. What geographic region to launch in first? (Start local, then expand?)
2. Mobile app in the future, or web-only initially?
3. Revenue model: Free forever, premium features for churches, or minimal ads?
4. How will you handle churches that close or merge?
5. Should users be able to suggest edits to church information?

---

**Next Steps**: 
1. Answer the open questions above
2. Set up your development environment
3. Create Supabase project and database
4. Start with the homepage and search functionality
